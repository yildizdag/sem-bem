function [N, dN] = shapefunc2D(xi,eta,p)
if p == 1
    N = zeros(size(xi,1),4);
    N(:,1) = 0.25.*(1-xi).*(1-eta);
    N(:,2) = 0.25.*(1+xi).*(1-eta);
    N(:,3) = 0.25.*(1+xi).*(1+eta);
    N(:,4) = 0.25.*(1-xi).*(1+eta);
    dN = zeros(2,4,size(xi,1));
    dN(1,1,:) = -0.25.*(1-eta);
    dN(1,2,:) =  0.25.*(1-eta);
    dN(1,3,:) =  0.25.*(1+eta);
    dN(1,4,:) = -0.25.*(1+eta);
    dN(2,1,:) = -0.25.*(1-xi);
    dN(2,2,:) = -0.25.*(1+xi);
    dN(2,3,:) =  0.25.*(1+xi);
    dN(2,4,:) =  0.25.*(1-xi);
elseif p == 2
    N = zeros(size(xi,1),9);
    N(:,1) = 0.25.*xi.*eta.*(1-xi).*(1-eta);
    N(:,2) = -0.25.*xi.*eta.*(1+xi).*(1-eta);
    N(:,3) = 0.25.*xi.*eta.*(1+xi).*(1+eta);
    N(:,4) = -0.25.*xi.*eta.*(1-xi).*(1+eta);
    N(:,5) = 0.5.*eta.*(1-xi.^2).*(1-eta);
    N(:,6) = 0.5.*xi.*(1-eta.^2).*(1+xi);
    N(:,7) = 0.5.*eta.*(1-xi.^2).*(1+eta);
    N(:,8) = 0.5.*xi.*(1-eta.^2).*(1-xi);
    N(:,9) = (1-xi.^2).*(1-eta.^2);
    dN = zeros(2,9,size(xi,1));
    dN(1,1,:) =  0.25.*eta.*(1-eta).*(1-2.*xi);
    dN(1,2,:) = -0.25.*eta.*(1-eta).*(1+2.*xi);
    dN(1,3,:) =  0.25.*eta.*(1+eta).*(1+2.*xi);
    dN(1,4,:) = -0.25.*eta.*(1+eta).*(1-2.*xi);
    dN(1,5,:) =  0.5.*eta.*(1-eta).*(-2.*xi);
    dN(1,6,:) =  0.5.*(1-eta.^2).*(1+2.*xi);
    dN(1,7,:) =  0.5.*eta.*(1+eta).*(-2.*xi);
    dN(1,8,:) =  0.5.*(1-eta.^2).*(1-2.*xi);
    dN(1,9,:) =  (1-eta.^2).*(-2.*xi);
    dN(2,1,:) =  0.25.*xi.*(1-xi).*(1-2.*eta);
    dN(2,2,:) = -0.25.*xi.*(1+xi).*(1-2.*eta);
    dN(2,3,:) =  0.25.*xi.*(1+xi).*(1+2.*eta);
    dN(2,4,:) = -0.25.*xi.*(1-xi).*(1+2.*eta);
    dN(2,5,:) =  0.5.*(1-xi.^2).*(1-2.*eta);
    dN(2,6,:) =  0.5.*xi.*(1+xi).*(-2.*eta);
    dN(2,7,:) =  0.5.*(1-xi.^2).*(1+2.*eta);
    dN(2,8,:) =  0.5.*xi.*(1-xi).*(-2.*eta);
    dN(2,9,:) =  (1-xi.^2).*(-2.*eta);
else
    disp('pBEM is 1 or 2');
end

